<div class="container">
    <div class="col-md-12 breadcrumb-header">
        <ul class="breadcrumb">
            <li><span (click)="voltar()" class="voltar"><i class="fa fa-arrow-left" aria-hidden="true"></i>Voltar</span>
            </li>
            <a routerLink="/home">Início</a>
            <em class="fa fa-chevron-right"></em> Administração
            <em class="fa fa-chevron-right"></em> Parâmetros
            <em class="fa fa-chevron-right"></em>
            <a routerLink="..">Medicamentos</a>
            <em class="fa fa-chevron-right"></em>
            Medicamentos – <span *ngIf="!id">Inclusão</span><span *ngIf="id">Edição</span>
        </ul>
    </div>

    <div class="title-type">
        <h1 class="titulo-pagina">
            Medicamentos – <span *ngIf="!id">Inclusão</span><span *ngIf="id">Edição</span>
        </h1>
    </div>

    <section class="row">
        <form [formGroup]="formulario" name="form">
            <!-- Informações do registro (somente edição) -->
            <div *ngIf="id" style="display: flex; flex-wrap: wrap; gap: 16px; margin-bottom: 24px; padding: 16px; background: #f5f5f5; border-radius: 4px;">
                <div style="flex: 1; min-width: 200px;">
                    <label class="control-label" for="id">ID</label>
                    <p class="marginBottom" id="id">{{id}}</p>
                </div>

                <div style="flex: 1; min-width: 200px;">
                    <label class="control-label" for="dataCadastramento">Cadastramento</label>
                    <p class="marginBottom"
                       id="dataCadastramento">{{medicamento?.dataCadastramento |date:'dd/MM/yyyy HH:mm:ss'}}</p>
                </div>

                <div style="flex: 1; min-width: 200px;">
                    <label class="control-label" for="codigoUsuarioCadastramento">Usuário</label>
                    <p class="marginBottom" id="codigoUsuarioCadastramento">{{medicamento?.codigoUsuarioCadastramento}}</p>
                </div>
            </div>

            <!-- Laboratório -->
            <div style="display: flex; flex-wrap: wrap; gap: 16px; margin-bottom: 16px;">
                <div style="flex: 1; min-width: 300px;">
                    <asc-dropdown [required]="true"
                    [items]="listComboLaboratorios"
                    label="Laboratório"
                    [control]="idLaboratorio"
                  ></asc-dropdown>
                </div>
            </div>

            <!-- Código e Nome do medicamento -->
            <div style="display: flex; flex-wrap: wrap; gap: 16px; margin-bottom: 16px;">
                <div style="flex: 1; min-width: 250px;">
                    <asc-input-text label="Código do medicamento" [required]="true" id="coMedicamento" name="coMedicamento" 
                    [control]="coMedicamento" hint="Código do medicamento" [maxlength]="6"></asc-input-text>
                </div>

                <div style="flex: 2; min-width: 300px;">
                    <asc-input-text label="Nome do medicamento" hint="Nome do medicamento" [required]="true" id="nome" 
                    name="nome" [control]="nome"  [maxlength]="150"></asc-input-text>
                </div>
            </div>

            <!-- Apresentação -->
            <div style="display: flex; flex-wrap: wrap; gap: 16px; margin-bottom: 16px;">
                <div style="flex: 0 0 200px; min-width: 150px;">
                    <asc-input-text label="Código Apresentação"  hint="Código Apresentação" [required]="true" 
                    id="codigoApresentacao" name="codigoApresentacao" [control]="codigoApresentacao" [maxlength]="4"></asc-input-text>
                </div>

                <div style="flex: 1; min-width: 300px;">
                <asc-input-text label="Apresentação" [required]="true" hint="Apresentação" [maxlength]="150"
                id="descricaoApresentacao" name="descricaoApresentacao" [control]="descricaoApresentacao" ></asc-input-text>
                </div>               
            </div>

            <!-- Valores e Quantidade -->
            <div style="display: flex; flex-wrap: wrap; gap: 16px; margin-bottom: 16px;">
                <div style="flex: 1; min-width: 180px;">
                  <asc-input-money-type [control]="formulario.get('valor')" inputId="valor"
                  [required]="true" label="Valor">
                  </asc-input-money-type>
                </div>

                <div style="flex: 1; min-width: 180px;">
                    <asc-input-text label="Quantidade Fracionada" hint="Quantidade Fracionada"  [required]="true" 
                    id="qtdFracionado" name="qtdFracionado" [somenteNumeros]="true" [control]="qtdFracionado" [maxlength]="5"></asc-input-text>
                </div>

                <div style="flex: 1; min-width: 180px;">
                  <asc-input-money-type [control]="formulario.get('valorFracionado')" inputId="valorFracionado"
                  [required]="true" label="Valor Fracionado">
                  </asc-input-money-type>
                </div>

                <div style="flex: 1; min-width: 150px;">
                    <asc-input-text [control]="formulario.get('percentualAliquota')" inputId="percentualAliquota"
                    [required]="true" label="Alíquota"  ascOnlyNumber [maxlength]="6"
                    (keydown)="onPercentChange()" (keyup)="onPercentChange()"  (focus)="onPercentChange()">
                    </asc-input-text>
                </div>
            </div>

            <!-- Código de Barras -->
            <div style="display: flex; flex-wrap: wrap; gap: 16px; margin-bottom: 16px;">    
                <div style="flex: 1; min-width: 300px; max-width: 600px;">
                    <asc-input-text label="Código de Barras" hint="Código de Barras" [somenteNumeros]="true" 
                    id="codigoBarraAnvisa" name="codigoBarraAnvisa" [control]="codigoBarraAnvisa"  [maxlength]="15"></asc-input-text>
                </div>
            </div>

            <!-- Números TISS, TUSS e Edição -->
            <div style="display: flex; flex-wrap: wrap; gap: 16px; margin-bottom: 16px;">    
                <div style="flex: 1; min-width: 200px;">
                    <asc-input-text label="Número TISS"  hint="Número TISS" [somenteNumeros]="true"
                    id="numeroTiss" name="numeroTiss" [control]="numeroTiss" [maxlength]="10" [required]="true"></asc-input-text>
                </div>
                     
                <div style="flex: 1; min-width: 200px;">
                    <asc-input-text label="Número TUSS" hint="Número TUSS" [somenteNumeros]="true" 
                    id="numeroTuss" name="numeroTuss" [control]="numeroTuss" [maxlength]="10"></asc-input-text>
                </div>
              
                <div style="flex: 1; min-width: 200px;">
                    <asc-input-text label="Nº Última Edição" hint="Nº Última Edição"  [somenteNumeros]="true" 
                    id="numeroUltimaEdicao" name="numeroUltimaEdicao" [control]="numeroUltimaEdicao" [maxlength]="3"></asc-input-text>
                </div>
            </div>

            <!-- Checkboxes e Data de Inativação -->
            <div style="display: flex; flex-wrap: wrap; gap: 24px; margin-bottom: 24px; align-items: center;">
                <div style="display: flex; align-items: center;">
                    <asc-checkbox label="Genérico" name="binary" formControlName="generico" [valoresTrueOrFalse]="true" (ngModelChange)="onChangeInativo($event)"></asc-checkbox>
                </div>

                <div style="display: flex; align-items: center;">
                    <asc-checkbox label="Inativo" name="binary" formControlName="inativo" [valoresTrueOrFalse]="true" (ngModelChange)="onChangeInativo($event)"></asc-checkbox>
                </div>
              
                <div *ngIf="inativo.value" style="flex: 1; min-width: 250px;">
                    <asc-input-date
                            [control]="dataInativacao" [required]="inativo.value"
                            [disabled]="!inativo.value" inputId="dataInativacao" label="Data da Inativação"
                    ></asc-input-date>
                    <asc-message-error
                            [control]="dataInativacao" type="dataIgualAtualMaior"
                            errorMessage="Data de Inativação deve ser igual ou superior a data atual!"
                    ></asc-message-error>
                </div>
            </div>
        
            <div class="col-xs-12 barra-botoes">
                <button class="btn back-btn" (click)="voltar()" id="btnFormVoltar">
                    <span class="fa fa-reply fa-fw"></span>
                    Voltar
                </button>

                <button class="btn clean-btn" (click)="excluir()" id="btnFormExcluir" *ngIf="id">
                    <span class="fa fa-remove fa-fw"></span>
                    Excluir
                </button>

                <button (click)="limparCampos()" class="btn back-btn" id="btnFormLimparCampos" *ngIf="!id">
                    <span class="fa fa-trash fa-fw"></span>
                    Limpar Campos
                </button>

                <button class="btn clean-btn" (click)="restaurarCampos()" id="btnFormRestaurar" *ngIf="id">
                    Restaurar Campos
                </button>

                <button class="btn continue-btn" (click)="salvar()" id="btnFormSalvar" [disabled]="formulario.invalid">
                    Salvar
                </button>
            </div>

        </form>
    </section>
</div>
