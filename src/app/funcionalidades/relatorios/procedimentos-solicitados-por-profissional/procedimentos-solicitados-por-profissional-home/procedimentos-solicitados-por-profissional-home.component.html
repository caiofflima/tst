<div class="container">
  <div class="col-md-12 breadcrumb-header">
    <div class="breadcrumb">
      <span (click)="voltar()" class="voltar"
        ><i class="fa fa-arrow-left" aria-hidden="true"></i>Voltar</span
      >
      <a routerLink="/home">Início</a>
      <em class="fa fa-chevron-right"></em>
      Relatórios
      <em class="fa fa-chevron-right"></em>
      Procedimentos Solicitados por Profissional
    </div>
  </div>

  <div class="title-type">
    <h1 class="titulo-pagina">Procedimentos Solicitados por Profissional</h1>
  </div>

  <div class="main-section">
    <form [formGroup]="formulario" name="form">

    <p class="info-search-label">Dados do pedido</p>

    <div class="row">
        <div class="col-md-3">
          <asc-multiSelect
            id="filial"
            label="Agrupadora"
            [options]="listComboFilial"
            [control]="formulario.get('filiaisProcesso')"
            size="large">
          </asc-multiSelect>
        </div>

        <div class="col-md-3">
          <asc-dropdown
            formControlName="ufAtendimento"
            label="UF Atendimento"
            [items]="listComboUF"
            [placeholder]="this.bundle('MHSPH')"
            size="large">
          </asc-dropdown>
        </div>

        <div class="col-md-6">
          <asc-multiSelect
            id="tipoProcesso"
            label="Tipo de Pedido"
            [options]="listComboTipoProcesso"
            [control]="formulario.get('tiposProcesso')"
            size="large">
          </asc-multiSelect>
        </div>
    </div>

    <div class="row">
      <div class="col-md-6">
        <asc-input-text
          [control]="formulario.get('cpfCnpjProfissional')"
          inputId="cpfCnpjProfissional"
          label="Profissional"
          [maxlength]="18"
          placeholder="Informe o CPF/CNPJ"
          size="large"
          (keydown)="checkCPFCNPJ(this.cpfCnpjProfissional)"
          (keyup)="checkCPFCNPJ(this.cpfCnpjProfissional)"
          (blur)="cpfCnpjUtil.control.configurarMascara(this.cpfCnpjProfissional)"
          (focus)="cpfCnpjUtil.control.limparFormatacao(this.cpfCnpjProfissional)">
        </asc-input-text>
      </div>

      <div class="col-md-6">
        <asc-dropdown
          formControlName="idProcedimento"
          label="Procedimento"
          [items]="listComboProcedimento"
          [placeholder]="this.bundle('MHSPH')"
          size="large">
        </asc-dropdown>
      </div>
    </div>

      <div class="row">
        <div class="col-md-3">
          <asc-input-date
            [required]="true"
            [control]="formulario.get('dataInicio')"
            inputId="dataInicio"
            label="Data Início"
            size="large">
          </asc-input-date>
        </div>

        <div class="col-md-3">
          <asc-input-date
            [required]="true"
            [control]="formulario.get('dataFim')"
            inputId="dataFim"
            label="Data Fim"
            size="large">
          </asc-input-date>
        </div>
      </div>
    
    </form>

    <div class="col-xs-12 barra-botoes">
      <button
        *ngIf="exibirResultado"
        class="btn clean-btn"
        title="Relatório Analítico"
        (click)="consultarRelatorioAnalitico()"
        [disabled]="loadingAnalitico"
        @fadeInOut
      >
        <span *ngIf="loadingAnalitico">
          <dsc-progress-spinner
            [style]="{ width: '23px', height: '23px' }"
            animationDuration=".5s"
            fill="#EEEEEE"
            strokeWidth="4"
          >
          </dsc-progress-spinner>
        </span>
        <span *ngIf="!loadingAnalitico">
          <span class="fa fa-list-alt fa-fw"></span>Analítico
        </span>
      </button>
      <button
        id="btnLimparCampos"
        class="btn back-btn"
        (click)="limparCampos()">
        <span class="fa fa-trash fa-fw"></span>Limpar Campos
      </button>
      <button
        class="btn continue-btn"
        (click)="consultarProcesso()"
        [disabled]="!validaFormulario()">
        <span class="fa fa-search fa-fw"></span>Pesquisar
      </button>
    </div>

    <div *ngIf="exibirResultado" class="col-xs-12 row p-0">
      <p-table
        [value]="listaProcessos"
        [paginator]="true"
        [rows]="rowCounter"
        [rowsPerPageOptions]="[5, 10, 20]"
        [totalRecords]="listaProcessos.length"
        class="table table-striped table-sm table-hover">
        <ng-template pTemplate="header">
          <tr>
            <th
              id="competencia"
              style="width: 60px"
              pSortableColumn="competencia"
            >
              Competência
            </th>
            <th
              id="siglaFilial"
              style="width: 30px"
              pSortableColumn="siglaFilial"
            >
              Agrupadora
            </th>
            <th
              id="ufAtendimento"
              style="width: 65px"
              pSortableColumn="ufAtendimento"
            >
              UF Atendimento
            </th>
            <th
              id="cpfCnpjStr"
              style="width: 80px"
              pSortableColumn="cpfCnpjStr"
            >
              "CPF/CNPJ
            </th>
            <th
              id="nomeRazaoSocial"
              style="width: 98px"
              pSortableColumn="nomeRazaoSocial"
            >
              Nome/Razão Social
            </th>
            <th
              id="procedimento"
              style="width: 200px"
              pSortableColumn="procedimento"
            >
              Procedimento
            </th>
            <th
              id="quantidadeProcessos"
              style="width: 60px"
              pSortableColumn="quantidadeProcessos"
            >
              Qtd. Pedidos
            </th>
            <th
              id="quantidadeProcedimentos"
              style="width: 72px"
              pSortableColumn="quantidadeProcedimentos"
            >
              Qtd. Procedimentos
            </th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-rowData>
          <tr>
            <td>{{ rowData.competencia }}</td>
            <td>{{ rowData.siglaFilial }}</td>
            <td>{{ rowData.ufAtendimento }}</td>
            <td>{{ rowData.cpfCnpjStr }}</td>
            <td>{{ rowData.nomeRazaoSocial }}</td>
            <td>{{ rowData.procedimento }}</td>
            <td>{{ rowData.quantidadeProcessos }}</td>
            <td>{{ rowData.quantidadeProcedimentos }}</td>
          </tr>
        </ng-template>

        <ng-template pTemplate="emptymessage">
          {{ bundle("MA003") }}
        </ng-template>
        <!-- <p-column field="competencia" header="Competência" [sortable]="true"
                  [style]="{width: '60px', 'text-align': 'center', color: '#555555'}">
        </p-column>
        <p-column field="siglaFilial" header="Agrupadora" [sortable]="true"
                  [style]="{width: '30px', 'text-align': 'center', color: '#555555'}">
        </p-column>
        <p-column field="ufAtendimento" header="UF Atendimento" [sortable]="true"
                  [style]="{width: '65px', 'text-align': 'center', color: '#555555'}">
        </p-column>
        <p-column field="cpfCnpjStr" header="CPF/CNPJ" [sortable]="true"
                  [style]="{width: '80px', 'text-align': 'center', color: '#555555'}">
        </p-column>
        <p-column field="nomeRazaoSocial" header="Nome/Razão Social" [sortable]="true"
                  [style]="{width: '98px', 'text-align': 'center', color: '#555555'}">
        </p-column>
        <p-column field="procedimento" header="Procedimento" [sortable]="true"
                  [style]="{width: '200px', 'text-align': 'center', color: '#555555'}">
        </p-column>
        <p-column field="quantidadeProcessos" header="Qtd. Pedidos" [sortable]="true"
                  [style]="{width: '60px', 'text-align': 'center', color: '#555555'}">
        </p-column>
        <p-column field="quantidadeProcedimentos" header="Qtd. Procedimentos" [sortable]="true"
                  [style]="{width: '72px', 'text-align': 'center', color: '#555555'}">
        </p-column> -->
        <p-footer>
          {{ mensagemPaginacao }}
        </p-footer>
      </p-table>
      <div class="row">
        <div class="col-md-12">
          <small>
            <p><strong>Legenda</strong></p>
            <p>
              <strong>Qtd. Pedidos</strong> - Quantidade total de pedidos que se
              enquadram nos critérios de pesquisa
            </p>
            <p>
              <strong>Qtd. Procedimentos</strong> - Soma das quantidades
              solicitadas do evento
            </p>
          </small>
        </div>
      </div>
    </div>
  </div>
</div>
