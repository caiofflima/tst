<form [formGroup]="form" #formDirective="ngForm">

  <div class="form-container">
    <div class="form-row">
      <div class="form-field-full">
        <asc-select-procedimento
          selectId="procedimento"
          [parametros]="parametroSelectProcedimento"
          [tipoAcaoService]="CONSULTAR_PROCEDIMENTO_POR_TIPO_PROCESSO"
          [control]="form.get('idProcedimento')"
          (dadoSelecionado)="procedimentoSelecionado($event)"
          formControlName="idProcedimento"
          [label]="'Procedimento'"
          [required]="true" style="border-left: none !important"
        ></asc-select-procedimento>
      </div>
    </div>

    <!-- Linha 1: Grau (1/2), Valor Unitário (1/2) -->
    <div class="form-row">
      <div class="form-field-half"
           *ngIf="mostrarCampo('idGrauProcedimento')">
        <asc-graus-procedimento
          selectId="grau"
          [parametros]="parametrosSelectGrauProcedimento"
          [control]="form.get('idGrauProcedimento')"
          (dadosBackend)="grauProcedimentoCarregado($event)"
          (dadoSelecionado)="grauProcedimentoSelecionado($event)"
          formControlName="idGrauProcedimento"
          [required]="true"
          label="Grau"
          style="border-left: none !important;"
        ></asc-graus-procedimento>
      </div>

      <div class="form-field-half"
           *ngIf="mostrarCampo('valorUnitarioPago')">
        <asc-input-money-type [control]="form.get('valorUnitarioPago')" inputId="valorUnitarioPago"
                              label="Valor unitário pago" [required]="true">
          <asc-input-error nomeErro="min"
                           [msgErro]="'O Valor Unitário Pago deve ser maior do que 0 (zero).'"></asc-input-error>
        </asc-input-money-type>
        <div class="error-form" *ngIf="erroValorDocumentoFiscal">{{ bundle('MA083') }}</div>
      </div>
    </div>

    <!-- Linha 2: Autorização Prévia (1/2), Data do Atendimento (1/2) -->
    <div class="form-row">
      <div class="form-field-half"
           *ngIf="mostrarCampo('idAutorizacaoPrevia') && hasGrauProcedimento()">
        <label class="control-label" [class.obrigatorio]="autorizacaoPreviaObrigatorio"
        >Autorização Prévia <small *ngIf="!autorizacaoPreviaObrigatorio">Opcional</small></label>
        <asc-select-autorizacao-previa
          selectId="autorizacaoPrevia"
          [parametros]="autorizacaoPreviaParams"
          [control]="form.get('idAutorizacaoPrevia')"
          (dadoSelecionado)="autorizacaoPreviaSelecionado($event)"
          (dadosBackend)="autorizacoesPreviasSelecionados($event)"
          formControlName="idAutorizacaoPrevia"
          label=""
          style="border-left: none !important;">
        </asc-select-autorizacao-previa>
      </div>

      <div class="form-field-half"
           *ngIf="mostrarCampo('dataAtendimento')">
        <asc-input-date [control]="form.get('dataAtendimento')" inputId="dataAtendimento" label="Data do atendimento"
                        [required]="true">
          <asc-input-error nomeErro="dataAtualMenor"
                           [msgErro]="'Data do atendimento deve ser menor ou igual à Data atual.'"></asc-input-error>
        </asc-input-date>
      </div>
    </div>

    <!-- Linha 3: Quantidade Solicitada (1/2 esquerda) -->
    <div class="form-row">
      <div class="form-field-half"
           *ngIf="mostrarCampo('idGrauProcedimento')">
        <asc-input-text
          label="Quantidade solicitada" [required]="true"
          [control]="form.get('qtdSolicitada')"
          inputId="qtdSolicitada"
          [somenteNumeros]="true"
          [maxlength]="3">
          <asc-input-error nomeErro="min" [msgErro]="bundle('MA012')"></asc-input-error>
          <asc-input-error nomeErro="max" [msgErro]="bundle('MA132')"></asc-input-error>
        </asc-input-text>
      </div>
    </div>
  </div>

  <div *ngIf="isToShowForm && enableAllAction" class=" flex-end">
    <asc-button-secondary
      buttonId="adicionarProcedimento"
      [title]="isEditing ? 'Concluir alteração' : 'Adicionar'"
      [showProgress]="loading"
      [disabled]="form?.invalid || loading"
      (onClick)="adicionarProcedimento(formDirective, $event)"
      style="margin-right: 8px;"
    ></asc-button-secondary>

    <asc-button-primary
      buttonId="limpar"
      [title]="isEditing ? 'Cancelar' : 'Limpar'"
      (onClick)="clickButtonCancelarProcedimento(formDirective, $event)"
    ></asc-button-primary>
  </div>

</form>
