<div class="row col-md-6 coluna-interna">
  <form [formGroup]="formProcedimento">
    <div class="row col-md-12">
      <label class="control-label obrigatorio" for="procedimento"
        >Procedimento</label
      >

      <asc-dropdown
  [control]="formProcedimento.get('procedimento')"
  [items]="itensProcedimento"
  [placeholder]="this.bundle('MHSPH')"
  (selected)="carregarGrausProcedimento()"
  id="procedimento"
></asc-dropdown>
      <asc-message-error
        [control]="formProcedimento.controls['procedimento']"
        type="required"
        [errorMessage]="bundle('MA005')"
      ></asc-message-error>
    </div>

    <div class="clearfix"></div>

    <div class="row col-md-7">
      <label
        class="control-label {{ classObrigatorio }}"
        for="grau"
        *ngIf="!isAutorizacaoODT()"
        >Grau</label
      >
      <label
        class="control-label {{ classObrigatorio }}"
        for="grau"
        *ngIf="isAutorizacaoODT()"
        >Região Odontológica</label
      >

      <asc-dropdown
  [control]="formProcedimento.controls['grauProcedimento']"
  [items]="itensGrauProcedimento"
  [placeholder]="this.bundle('MHSPH')"
></asc-dropdown>
      <div
        *ngIf="
          isGrauProcedimentoInvalido() &&
          (grauProcedimento.dirty || grauProcedimento.touched)
        "
        class="error-form"
      >
        <div *ngIf="grauObrigatorio()">{{ bundle("MA005") }}</div>
      </div>
    </div>

    <div class="row col-md-4">
      <label class="control-label obrigatorio" for="qtdeSolicitada"
        >Quantidade</label
      >
      <input
        required
        type="text"
        id="qtdeSolicitada"
        class="form-control"
        formControlName="qtdSolicitada"
        maxlength="5"
        title="Quantidade do procedimento solicitada."
        (keyup)="constantes.control.numeroMaiorQueZero(this.qtdSolicitada)"
        (keydown)="constantes.control.numeroMaiorQueZero(this.qtdSolicitada)"
      />

      <div
        *ngIf="
          qtdSolicitada.invalid &&
          (qtdSolicitada.dirty || qtdSolicitada.touched)
        "
        class="error-form"
      >
        <div *ngIf="qtdSolicitada.errors['required']">
          {{ bundle("MA007") }}
        </div>
        <div *ngIf="qtdSolicitada.errors['menorIgualZero']">
          {{ bundle("MA012") }}
        </div>
        <div *ngIf="qtdSolicitada.errors['numeroInvalido']">
          Informe um número válido
        </div>
      </div>
    </div>

    <div class="row col-md-8">
      <button
        id="btnSalvarAlteracaoProcedimento"
        class="btn btn-success posicao-campo"
        (click)="salvarAlteracao()"
        *ngIf="isAlteracao()"
      >
        <span class="fa fa-check fa-fw"></span>Salvar Alteração
      </button>
      <button
        id="btnCancelarAlteracaoProcedimento"
        class="btn btn-danger posicao-campo"
        (click)="cancelarAlteracao()"
        *ngIf="isAlteracao()"
      >
        <span class="fa fa-close fa-fw"></span>Cancelar Alteração
      </button>
      <button
        id="btnAdicionarProcedimento"
        class="btn btn-success posicao-campo"
        (click)="adicionarProcedimento()"
        *ngIf="!isAlteracao()"
      >
        <span class="fa fa-plus fa-fw"></span>Adicionar Procedimento
      </button>
      <button
        id="btnLimparCampos"
        class="btn btn-info posicao-campo"
        (click)="limparCampos()"
        *ngIf="!isAlteracao() && !rascunhoPedido"
      >
        <span class="fa fa-trash fa-fw"></span>Limpar Campos
      </button>
    </div>
  </form>
</div>

<div class="row col-md-6 coluna-interna">
  <div class="row col-md-12">
    <label class="control-label" for="descricao"
      >Descrição do Procedimento</label
    >
    <p class="descricaoProcedimento" id="descricao">
      {{ procedimento.value?.observacaoProcedimento }}
    </p>
  </div>
</div>

<div class="clearfix"></div>

<div class="row col-md-12">
  <h4>Procedimentos do Pedido</h4>
</div>

<div class="row col-md-12">
  <p-table
    emptyMessage="Nenhum registro encontrado"
    [value]="listaPedidosProcedimento"
    [paginator]="true"
    [rows]="10"
    [rowsPerPageOptions]="[5, 10, 20]"
    class="table table-striped table-sm table-hover"
    #dt
  >
    <!-- <p-column field="procedimento" header="Procedimento" [sortable]="true"> -->
    <ng-template let-col let-row="rowData" pTemplate="body">
      {{ row[col.field].estruturaNumerica | estruturaProcedimento }} -
      {{ row[col.field].descricaoProcedimento }}
    </ng-template>
    <!-- </p-column> -->
    <!-- <p-column field="grauProcedimento" [sortable]="true"> -->
    <ng-template pTemplate="header">
      <span *ngIf="!isAutorizacaoODT()">Grau</span>
      <span *ngIf="isAutorizacaoODT()">Região Odontológica</span>
    </ng-template>
    <ng-template let-row="rowData" pTemplate="content">
      {{ row?.grauProcedimento?.nome }}
    </ng-template>
    <!-- </p-column> -->
    <!-- <p-column field="qtdSolicitada" header="Quantidade" [sortable]="true"></p-column> -->

    <!-- <p-column field="qtdSolicitada" header="Ação"> -->
    <ng-template let-col let-row="rowData" pTemplate="content">
      <button
        class="btn btn-default"
        title="Editar procedimento"
        (click)="editar(row)"
        *ngIf="!row.validado && !isAlteracao()"
      >
        <span class="fa fa-edit fa-fw"></span>
      </button>
      <button
        class="btn btn-danger"
        title="Excluir procedimento"
        (click)="excluir(row)"
        *ngIf="!row.validado && !isAlteracao()"
      >
        <span class="fa fa-close fa-fw"></span>
      </button>
    </ng-template>
    <!-- </p-column> -->
  </p-table>
</div>
